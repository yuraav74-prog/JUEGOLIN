<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Clasificaci√≥n de Animales - Terrestres y Acu√°ticos</title>
  <style>
    body {
      font-family: 'Comic Sans MS', cursive, sans-serif;
      margin: 0;
      padding: 20px;
      text-align: center;
      background: linear-gradient(to right, #58d68d 50%, #5dade2 50%);
      height: 100vh;
      box-sizing: border-box;
      overflow-y: auto;
    }
    #header-img {
      max-width: 100%;
      height: auto;
      max-height: 150px;
      margin-bottom: 10px;
    }
    .instrucciones {
      font-size: 18px;
      max-width: 600px;
      margin: 10px auto 20px;
      line-height: 1.4;
      color: #333;
      background: rgba(255,255,255,0.85);
      padding: 10px 15px;
      border-radius: 8px;
    }
    #error-msg {
      color: red;
      font-weight: bold;
      font-size: 20px;
      height: 30px;
      margin-bottom: 15px;
      opacity: 0;
      transition: opacity 0.5s;
      background: rgba(255,255,255,0.9);
      border-radius: 6px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    .classification-container {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-bottom: 25px;
      background: rgba(255,255,255,0.9);
      padding: 15px 20px;
      border-radius: 12px;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }
    .zone-box {
      border: 2px solid #333;
      border-radius: 10px;
      width: 280px;
      min-height: 300px;
      background: white;
      padding: 10px;
      box-sizing: border-box;
      user-select: none;
      display: flex;
      flex-direction: column;
    }
    .zone-box h2 {
      margin-top: 0;
      margin-bottom: 10px;
      font-size: 20px;
      color: #007bff;
      text-align: center;
    }
    .drop-zone {
      border: 2px dashed #999;
      border-radius: 8px;
      flex-grow: 1;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      padding: 5px;
      overflow-y: auto;
      background-color: #f9f9f9;
      min-height: 200px;
    }
    .drop-zone.matched {
      border-color: #28a745;
      background-color: #d4edda;
    }
    .animals {
      max-width: 700px;
      margin: 0 auto 15px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      background: rgba(255,255,255,0.9);
      padding: 10px;
      border-radius: 10px;
      user-select: none;
      max-height: 220px;
      overflow-y: auto;
    }
    .animal-box {
      width: 60px;
      height: 60px;
      border: 2px solid #333;
      border-radius: 10px;
      background: #fff;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 5px;
      user-select: none;
      transition: box-shadow 0.3s, border-color 0.3s;
    }
    .animal-box.selected {
      border-color: #007bff;
      box-shadow: 0 0 8px 3px #007bff;
    }
    .animal-box img {
      max-width: 100%;
      max-height: 100%;
      pointer-events: none;
      object-fit: contain;
    }
    #congrats {
      font-size: 24px;
      color: green;
      margin-top: 30px;
      display: none;
      background: rgba(255,255,255,0.9);
      padding: 10px;
      border-radius: 8px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }
    #restart-btn {
      display: none;
      margin-top: 20px;
      padding: 10px 25px;
      font-size: 18px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      user-select: none;
    }
    .nav-buttons {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 20px;
    }
    .nav-btn {
      width: 50px;
      height: 50px;
      font-size: 24px;
      border: none;
      border-radius: 50%;
      background-color: #007bff;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s;
      user-select: none;
    }
    .nav-btn:hover {
      background-color: #0056b3;
      transform: scale(1.1);
    }
  </style>
</head>
<body>

  <div style="text-align: center;">
    <img id="header-img" src="ANIMALES.png" alt="Imagen de clasificaci√≥n de animales" />
  </div>

  <div class="instrucciones" id="instrucciones">
    Arrastra cada animal a la categor√≠a correcta: Terrestres (izquierda) o Acu√°ticos (derecha). Haz clic en el animal para escuchar su nombre.<br>
    (En m√≥vil/tablet: toca un animal para seleccionarlo, luego toca la categor√≠a para colocar)
  </div>

  <div id="error-msg"></div>

  <div class="classification-container">
    <div class="zone-box">
      <h2>Animales Terrestres</h2>
      <div class="drop-zone" data-zone="terrestre"></div>
    </div>
    <div class="zone-box">
      <h2>Animales Acu√°ticos</h2>
      <div class="drop-zone" data-zone="acuatico"></div>
    </div>
  </div>

  <div class="animals" id="animals"></div>

  <div id="congrats">¬°Muy bien! Has clasificado todos los animales correctamente.</div>

  <button id="restart-btn" onclick="initGame()">Reiniciar</button>

  <div class="nav-buttons">
    <button class="nav-btn" onclick="location.href='4.html'" title="Regresar">‚Üê</button>
  </div>

<script>
  const animalsData = [
    { name: 'Perro', img: 'perro.png', type: 'terrestre' },
    { name: 'Borrego', img: 'borrego.png', type: 'terrestre' },
    { name: 'Gato', img: 'gato.png', type: 'terrestre' },
    { name: 'Conejo', img: 'conejo.png', type: 'terrestre' },
    { name: 'Vaca', img: 'vaca.png', type: 'terrestre' },
    { name: 'Elefante', img: 'elefante.png', type: 'terrestre' },
    { name: 'Jirafa', img: 'jirafa.png', type: 'terrestre' },
    { name: 'Rat√≥n', img: 'raton.png', type: 'terrestre' },
    { name: 'Chango', img: 'chango.png', type: 'terrestre' },
    { name: 'Pulpo', img: 'pulpo.png', type: 'acuatico' },
    { name: 'Caballo de Mar', img: 'caballodemar.png', type: 'acuatico' },
    { name: 'Pez', img: 'pez.png', type: 'acuatico' },
    { name: 'Estrella', img: 'estrella.png', type: 'acuatico' },
    { name: 'Tortuga', img: 'tortuga.png', type: 'acuatico' },
    { name: 'Pez Globo', img: 'pezglobo.png', type: 'acuatico' },
    { name: 'Cangrejo', img: 'cangrejo.png', type: 'acuatico' }
  ];

  const animalsContainer = document.getElementById('animals');
  const dropZones = document.querySelectorAll('.drop-zone');
  const errorMsg = document.getElementById('error-msg');
  const congrats = document.getElementById('congrats');
  const restartBtn = document.getElementById('restart-btn');
  const instrucciones = document.getElementById('instrucciones');

  let matchedCount = 0;
  let selectedAnimal = null;

  function playAudio(text) {
    if ('speechSynthesis' in window) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'es-ES';
      window.speechSynthesis.speak(utterance);
    }
  }

  function showError(message) {
    errorMsg.textContent = message;
    errorMsg.style.opacity = '1';
    playAudio('Error, intenta de nuevo');
    setTimeout(() => errorMsg.style.opacity = '0', 2000);
  }

  function shuffle(array) {
    let currentIndex = array.length, randomIndex;
    while(currentIndex !== 0) {
      randomIndex = Math.floor(Math.random() * currentIndex);
      currentIndex--;
      [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
    }
    return array;
  }

  function initGame() {
    matchedCount = 0;
    selectedAnimal = null;
    congrats.style.display = 'none';
    restartBtn.style.display = 'none';
    errorMsg.style.opacity = '0';
    animalsContainer.innerHTML = '';
    dropZones.forEach(zone => {
      zone.innerHTML = '';
      zone.classList.remove('matched');
    });

    playAudio("ANIMALES");
    setTimeout(() => {
      playAudio(instrucciones.textContent);
    }, 1500);

    const shuffledAnimals = shuffle([...animalsData]);
    shuffledAnimals.forEach(animal => {
      const div = document.createElement('div');
      div.className = 'animal-box';
      div.dataset.type = animal.type;
      div.dataset.name = animal.name;
      div.title = animal.name;
      div.innerHTML = `<img src="${animal.img}" alt="${animal.name}" />`;
      div.onclick = () => {
        playAudio(animal.name);
        selectAnimal(div);
      };
      animalsContainer.appendChild(div);
    });

    addDropZoneListeners();
  }

  function selectAnimal(animalDiv) {
    if (selectedAnimal) {
      selectedAnimal.classList.remove('selected');
      if (selectedAnimal === animalDiv) {
        // Deseleccionar si se clickea el mismo animal otra vez
        selectedAnimal = null;
        return;
      }
    }
    selectedAnimal = animalDiv;
    selectedAnimal.classList.add('selected');
  }

  function addDropZoneListeners() {
    dropZones.forEach(zone => {
      zone.addEventListener('click', () => {
        if (!selectedAnimal) {
          showError('Selecciona un animal primero');
          return;
        }
        const zoneType = zone.dataset.zone;
        if (selectedAnimal.dataset.type === zoneType) {
          zone.appendChild(selectedAnimal);
          selectedAnimal.classList.remove('selected');
          selectedAnimal.style.cursor = 'default';
          selectedAnimal.onclick = () => playAudio(selectedAnimal.dataset.name); // mantener audio
          selectedAnimal = null;
          matchedCount++;
          if (matchedCount === animalsData.length) {
            congrats.style.display = 'block';
            restartBtn.style.display = 'inline-block';
          }
        } else {
          showError('‚ùå ¬°Error! Intenta de nuevo üòä');
        }
      });
    });
  }

  window.onload = initGame;
</script>

</body>
</html>
